+++
title = 'å¡ç‰¹å…°æ•°'
date = 2023-11-05T19:01:44+08:00
tags = ['stack']
categories = 'algorithm'
enableLaTeX = true
+++

å¡ç‰¹å…°æ•° Catalan number æ˜¯ä¸€ä¸ªæ•°åˆ—ï¼Œå¯ä»¥ç”¨åœ¨è®¡ç®— n ä¸ªå…ƒç´ è¿›å‡ºæ ˆçš„æƒ…å†µæ•°ç›®ã€‚ä¾‹å¦‚ä¸€ä¸ªåºåˆ—ä»¥ `1 2 3 4` çš„é¡ºåºå…¥æ ˆï¼Œæœ‰å¤šå°‘ç§å‡ºæ ˆæƒ…å†µï¼Ÿ


<!--more-->

# ç†è®º

æ¨å¯¼è¿‡ç¨‹å¦‚ä¸‹ï¼Œä¸»è¦ä½¿ç”¨äº†åˆ†æ²»æ€æƒ³ã€‚

ä¸€ä¸ªåºåˆ—çš„å…¥æ ˆé¡ºåºç¡®å®šï¼Œé‚£ä¹ˆå‡ºæ ˆé¡ºåºå°±æœ‰äº†é™åˆ¶

1. æŸå…ƒç´ å‡ºæ ˆå¿…é¡»åœ¨å…¥æ ˆä¹‹å
2. æŸå…ƒç´ å‡ºæ ˆå¿…é¡»åœ¨æ ˆé¡¶

å°†å‡ºå…¥æ ˆé¡ºåºæ”¾åœ¨ä¸€èµ·ï¼Œå¯ä»¥åˆ’åˆ†ä¸ºå¤šç§æƒ…å†µï¼Œæ¯ç§æƒ…å†µéƒ½æ˜¯åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œåˆ†ç•Œçº¿ä¸ºæ ˆç©ºã€‚
ä¸‹é¢ä»¥å¸¦åœˆä¸ºå…¥æ ˆï¼Œä¸å¸¦åœˆä¸ºå‡ºæ ˆè¯´æ˜ï¼Œå…¥æ ˆé¡ºåºç¡®å®š
$\textcircled{1}\textcircled{2}\textcircled{3}\textcircled{4}$
ï¼Œ
å‡ºå…¥æ ˆé¡ºåºå¯ä»¥æ˜¯
$\textcircled{1}1|\textcircled{2}2\textcircled{3}3\textcircled{4}4$
ã€
$\textcircled{1}\textcircled{2}21|\textcircled{3}3\textcircled{4}4$
ã€
$\textcircled{1}\textcircled{2}2\textcircled{3}31|\textcircled{4}4$
ç­‰ã€‚

åœ¨ç«–çº¿ `|` å¤„ç¬¬ä¸€æ¬¡å‡ºç°æ ˆç©ºï¼Œå°†å‡ºå…¥æ ˆé¡ºåºåˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè¿™ä¸¤éƒ¨åˆ†æ˜¯ä¸¤ä¸ªæ›´å°çš„æœ¬ç±»å­é—®é¢˜ã€‚
ç”±äº**è¦æ±‚æ ˆç©º**ï¼Œç¬¬ä¸€ä¸ªå…¥æ ˆå…ƒç´ å¿…é¡»æœ€åä¸€ä¸ªå‡ºæ ˆï¼Œå®é™…ç¬¬ä¸€ä¸ªå­é—®é¢˜æ˜¯ä¸€ä¸ªå…ƒç´ ä¸ªæ•°-1 çš„å­é—®é¢˜ã€‚
æ ¹æ®ä¹˜æ³•æ³•åˆ™å’ŒåŠ æ³•æ³•åˆ™ï¼Œå¯ä»¥å¾—åˆ°æœ¬ç±»é—®é¢˜çš„é€’æ¨å…¬å¼ï¼š
è®¾ $n$ ä¸ªå…ƒç´ ä»¥ç¡®å®šé¡ºåºå…¥æ ˆæœ‰ $f(n)$ ç§å‡ºæ ˆæƒ…å†µï¼Œåˆ™

$$f(n)=f(0)f(n-1)+\dots+f(n-1)f(0)=\sum\limits_{i=0}^{n-1}f(i)f(n-i)$$

è§„å®š $f(0)=1$ ä¸” $n\ge1$ï¼Œæ¥ä¸‹æ¥æ˜¯æ•°å­¦é—®é¢˜ï¼Œæ¨å¯¼è¿‡ç¨‹æ—¥åç ”ç©¶ã€‚

æ‘˜æŠ„ç½‘ä¸Šçš„é€’æ¨å…¬å¼å’Œé€šé¡¹å…¬å¼ï¼š

$$f(n+1)=\dfrac{4n+2}{n+2}f(n)$$

$$f(n)=\dfrac{1}{n+1}C_{2n}^{n}=\dfrac{1}{n+1}\dfrac{(2n)!}{(n!)^2}$$

# ç¼–ç¨‹

Julia è®¡ç®—å¡ç‰¹å…°æ•°

```
f(n)=reduce(div,[factorial(big(2n)),factorial(big(n))^2,n+1])
f.(0:10:100)
                                                         1
                                                     16796
                                                6564120420
                                          3814986502092304
                                    2622127042276492108820
                              1978261657756160653623774456
                        1583850964596120042686772779038896
                  1321422108420282270489942177190229544600
            1136359577947336271931632877004667456667613940
      1000134600800354781929399250536541864362461089950800
 896519947090131496687170070074100632420837521538745909320
```

Python

```
import math
def catalan(n: int) -> int:
	return math.comb(2*n, n) // (n+1)
for i in range(0, 101, 10):
	print(catalan(i))
1
16796
6564120420
3814986502092304
2622127042276492108820
1978261657756160653623774456
1583850964596120042686772779038896
1321422108420282270489942177190229544600
1136359577947336271931632877004667456667613940
1000134600800354781929399250536541864362461089950800
896519947090131496687170070074100632420837521538745909320
```

æµ‹è¯• Julia å’Œ Python ç¨‹åºï¼Œæ¯«æ— æ„å¤– Julia æ€§èƒ½æ›´å¥½ã€‚åŒæ—¶è®¡ç®—ç¬¬ 1_000_000 ä¸ªå¡ç‰¹å…°æ•°ï¼ŒJulia ç§’å‡ºï¼ŒPython å®•æœºã€‚

sympy æœ‰ä¸€ä¸ª catalan å‡½æ•°ï¼Œæ¯”åŸç”Ÿ Python é€Ÿåº¦å¿«ï¼Œä½†ç›¸è¾ƒäº Julia è¿˜æ˜¯ä¹Œé¾Ÿæ…¢ã€‚ğŸ˜€
